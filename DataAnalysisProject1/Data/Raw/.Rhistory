plot(loansData$Interest.Rate ~ jitter(log(as.numeric(Monthly.Income+1))))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Monthly.Income+1)))
summery(lm1)
summary(lm1)
lines(log(as.numeric(Monthly.Income+1),lm1$fitted, col="red", lwd=3)
)
lines(log(as.numeric(Monthly.Income+1)),lm1$fitted, col="red", lwd=3)
lines(log(as.numeric(Monthly.Income[!is.na(Monthly.Income)]+1)),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Home.Ownership)))
meanRateHM <- tapply(loansData$Interest.Rate,Home.Ownership,mean)
points(1:5,meanRateHM,col="red", lwd=3)
points(1:5,meanRateHM,col="red",cex=5,pch="-")
plot(loansData$Interest.Rate ~ jitter(as.factor(Home.Ownership)))
as.factor(Home.Ownership)
as.numeric(Home.Ownership)
Home.Ownership[as.numeric(Home.Ownership)==2]
Home.Ownership[as.numeric(Home.Ownership)==3]
plot(loansData$Interest.Rate ~ jitter(as.numeric(State)))
meanRateHM <- tapply(loansData$Interest.Rate,State,mean)
meanRateSt <- tapply(loansData$Interest.Rate,State,mean)
points(1:50,meanRateSt,col="red",cex=5,pch="-")
points(1:49,meanRateSt,col="red",cex=5,pch="-")
points(1:48,meanRateSt,col="red",cex=5,pch="-")
unique(State)
points(1:46,meanRateSt,col="red",cex=5,pch="-")
lm1 <- lm(Interest.Rate ~ as.factor(State))
summary(lm1)
anova(lm1)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Debt.To.Income.Ratio)))
lm1 <- lm(loansData$Interest.Rate ~ as.numeric((Debt.To.Income.Ratio))
)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric((Debt.To.Income.Ratio)))
lines(as.numeric(Debt.To.Income.Ratio),lm1$fitted, col="red", lwd=3)
summary(lm1)
anova(lm1)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Loan.Purpose)))
axis(side=1,at=unique(as.numeric(Loan.Purpose)),labels=unique(Loan.Purpose))
plot(loansData$Interest.Rate ~ jitter(as.numeric(Loan.Purpose)))
meanRateLP <- tapply(loansData$Interest.Rate,Loan.Purpose,mean)
points(1:14,meanRateLP,col="red",cex=5,pch="-")
lm1<- lm(Interest.Rate <- as.factor(Loan.Purpose))
lm1<- lm(Interest.Rate ~ as.factor(Loan.Purpose))
lm1<- lm(as.numeric(Interest.Rate) ~ as.factor(Loan.Purpose))
summary lm1
summary(lm1)
confint(lm1)
class(Interest.Rate)
loansData$Interest.Rate = gsub("%","",loansData$Interest.Rate)
loansData$Debt.To.Income.Ratio = gsub("%","",loansData$Debt.To.Income.Ratio)
loansData$Interest.Rate <- as.numeric(loansData$Interest.Rate)
loansData$Debt.To.Income.Ratio <- as.numeric(loansData$Debt.To.Income.Ratio)
class(Interest.Rate)
class(LoansData$Interest.Rate)
class(loansData$Interest.Rate)
attach(loansData)
unattach(loansData)
detach(loansData)
attach(loansData)
plot(loansData$Interest.Rate ~ jitter(log(as.numeric(Revolving.CREDIT.Balance+1))))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
summary(lm1)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Employment.Length)))
meanRateEmp <- tapply(loansData$Interest.Rate,Employment.Length,mean)
points(1:12,meanRateEmp,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate,as.numeric(Employment.Length)
)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(Employment.Length))
summary(lm1)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Home.Ownership)))
meanRateHM <- tapply(loansData$Interest.Rate,as.numeric(Home.Ownership,mean)
points(1:5,meanRateHM,col="red",cex=5,pch="-")
plot(loansData$Interest.Rate ~ jitter(as.numeric(Home.Ownership)))
meanRateHM <- tapply(loansData$Interest.Rate,as.numeric(Home.Ownership,mean)
points(1:5,meanRateHM,col="red",cex=5,pch="-")
plot(loansData$Interest.Rate ~ jitter(as.numeric(Home.Ownership)))
meanRateHM <- tapply(loansData$Interest.Rate,as.numeric(Home.Ownership,mean))
points(1:5,meanRateHM,col="red",cex=5,pch="-")
unique(Home.Ownership)
plot(loansData$Interest.Rate ~ jitter(as.numeric(Home.Ownership)))
meanRateHM <- tapply(loansData$Interest.Rate,as.numeric(Home.Ownership),mean)
points(1:5,meanRateHM,col="red",cex=5,pch="-")
plot(loansData$Interest.Rate ~ jitter(as.numeric(Loan.Purpose)))
meanRateLP <- tapply(loansData$Interest.Rate,Loan.Purpose,mean)
points(0:14,meanRateLP,col="blue",pch="-",cex=5)
points(1:14,meanRateLP,col="blue",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.factor(Loan.Purpose))
summary(lm1)
Unique(Loan.Purpose)
unique(Loan.Purpose)
anova(lm1)
TukeyHSD
TukeyHSD(lm1)
lm1 <- aov(loansData$Interest.Rate ~ as.factor(Loan.Purpose))
TukeyHSD(lm1)
class(Amount.Funded.By.Investors)
class(Interest.Rate)
class(loansData$Interest.Rate)
plot(loansData$Interest.Rate ~ jitter(Amount.Funded.By.Investors))
lm1 <- lm(loansData$Interest.Rate ~ Amount.Funded.By.Investors)
summary(lm1)
lines(Amount.Funded.By.Investors, lm1$fitted, col="red", lwd=3)
lmFinal <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range) + as.numeric(loansData$Loan.Length) + log(as.numeric(Revolving.CREDIT.Balance+1) + as.numeric((Debt.To.Income.Ratio) + as.factor(Loan.Purpose) + Amount.Funded.By.Investors )
)
)
lmFinal <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range) + as.numeric(loansData$Loan.Length) + log(as.numeric(Revolving.CREDIT.Balance+1)) + as.numeric((Debt.To.Income.Ratio)) + as.factor(Loan.Purpose) + Amount.Funded.By.Investors )
summary(lmFinal)
lmFinal <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range) + as.numeric(loansData$Loan.Length) + log(as.numeric(Revolving.CREDIT.Balance+1)) + as.numeric((Debt.To.Income.Ratio)) + Amount.Funded.By.Investors )
summary(lmFinal)
lmFinal <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range) + as.numeric(loansData$Loan.Length) + log(as.numeric(Revolving.CREDIT.Balance+1)) + Amount.Funded.By.Investors )
summary(lmFinal)
anova(lmFinal)
confint(lmFinal)
source('~/.active-rstudio-document')
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ jitter(log(as.numeric(Revolving.CREDIT.Balance+1))))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)))
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(Amount.Funded.By.Investors))
lm1 <- lm(loansData$Interest.Rate ~ Amount.Funded.By.Investors)
lines(Amount.Funded.By.Investors, lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
plot(loansData$Interest.Rate ~ jitter(log(as.numeric(Revolving.CREDIT.Balance+1))))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate")
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
sub="a")
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
,sub="a")
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
)
axis(1, at=as.numeric(loansData$Loan.Length), labels=as.factor(loansData$Loan.Length), pos=, lty=, col=, las=, tck=, ...)
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
)
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
pch=19)
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
pch=19, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate"
,pch=19, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance", ylab="Interest Rate"
,pch=19, xaxt="n")
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance", ylab="Interest Rate"
,pch=19)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate"
,pch=19)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
,pch=19, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
,pch=19)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
,pch=10, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
,pch=19)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
mtext(text="(a)",side=3,line=1)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="FICO Range", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range))
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="FICO Range", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", side=1, line=1)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", side=1, line=2)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 2)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="" ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 3)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="" ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 3)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 3)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 4)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
#Amount Funded
plot(loansData$Interest.Rate ~ jitter(Amount.Funded.By.Investors))
lm1 <- lm(loansData$Interest.Rate ~ Amount.Funded.By.Investors)
lines(Amount.Funded.By.Investors, lm1$fitted, col="red", lwd=3)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
mtext(text="(a)",side=3,line=1)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
mtext(text="(b)",side=3,line=1)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 4)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
mtext(text="(c)",side=3,line=1)
#Amount Funded
plot(loansData$Interest.Rate ~ jitter(Amount.Funded.By.Investors), xlab="Amount Funded", ylab="Interest Rate (%)")
lm1 <- lm(loansData$Interest.Rate ~ Amount.Funded.By.Investors)
lines(Amount.Funded.By.Investors, lm1$fitted, col="red", lwd=3)
mtext(text="(d)",side=3,line=1)
par(mfrow=c(2,2))
#Strong Relationship for Loan Length
plot(loansData$Interest.Rate ~ jitter(as.numeric(loansData$Loan.Length)), xlab="Loan Length", ylab="Interest Rate (%)"
, xaxt="n")
axis(1, at=unique(as.numeric(loansData$Loan.Length)), labels=unique(loansData$Loan.Length))
meanRateLL <- tapply(loansData$Interest.Rate,loansData$Loan.Length,mean)
points(1:2,meanRateLL,col="red",pch="-",cex=5)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(loansData$Loan.Length))
lines(loansData$Loan.Length,lm1$fitted, col="red", lwd=3)
mtext(text="(a)",side=3,line=1)
#strong relatioship with Credit Balance
plot(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)), xlab="Revolving Credit Balance (Log10)", ylab="Interest Rate (%)"
)
lm1 <- lm(loansData$Interest.Rate ~ log(as.numeric(Revolving.CREDIT.Balance+1)))
lines(log(as.numeric(loansData$Revolving.CREDIT.Balance[!is.na(Revolving.CREDIT.Balance)]+1)), lm1$fitted, col="red", lwd=3)
mtext(text="(b)",side=3,line=1)
#Strong Correlation with FICO.Range
plot(loansData$Interest.Rate ~ jitter(as.numeric(FICO.Range)), xlab="", ylab="Interest Rate (%)"
)
axis(1, at=unique(as.numeric(FICO.Range)), labels=unique(FICO.Range), las=2)
mtext("FICO Score Range", 1, 4)
lm1 <- lm(loansData$Interest.Rate ~ as.numeric(FICO.Range))
lines(as.numeric(FICO.Range),lm1$fitted, col="red", lwd=3)
mtext(text="(c)",side=3,line=1)
#Amount Funded
plot(loansData$Interest.Rate ~ jitter(Amount.Funded.By.Investors), xlab="Amount Funded ($)", ylab="Interest Rate (%)")
lm1 <- lm(loansData$Interest.Rate ~ Amount.Funded.By.Investors)
lines(Amount.Funded.By.Investors, lm1$fitted, col="red", lwd=3)
mtext(text="(d)",side=3,line=1)
rm(ls)
ls
rm(ls())
rm(ls)
rm(list-ls())
rm(list=ls())
library(datasets)
data(iri)
data(iris)
iris
iris[,4]
iris[,1:4]
subs<-iris[,1:4]
subsDist <- dist(subs)
hCluster <- hclust(subsDist)
plot(hCluster)
vars <- load("https://spark-public.s3.amazonaws.com/dataanalysis/quiz3question4.rda ")
vars <- load("https://spark-public.s3.amazonaws.com/dataanalysis/quiz3question4.rda")
vars <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/quiz3question4.csv")
View(vars)
View(vars)
plot(vars$x,vars$y)
kmeansObj <- kmeans(vars,centers=2)
plot(vars$x,vars$y,col=kmeansObj$cluster,pch=19,cex=2)
points(kmeansObj$centers,col=1:2,pch=3,cex=3,lwd=3)
?kmeans
kmeansObj <- kmeans(vars,centers=2,nstart=100)
plot(vars$x,vars$y,col=kmeansObj$cluster,pch=19,cex=2)
rm(list=ls())
library(ElemStatLearn)
library(2lemStatLearn)
library(elemStatLearn)
install.packages("ElemStatLearn")
library(elemStatLearn)
library(ElemStatLearn)
data(zip.train)
im = zip2image(zip.train,3)
image(im)
par(mfrow(c(1,1))
)
par(mfrow=c(1))
par(mfrow=c(1,1))
image(im)
im8 = zip2image(zip.train,8)
im18 = zip2image(zip.train,18)
image(im8)
image(im18)
svd8 <- svd(scale(im8))
plot(svd8$d^2/sum(svd8$d^2),xlab="Column",ylab="Percent of variance explained",pch=19)
svd8$d^2/sum(svd8$d^2)
svd16 <- svd(scale(im16))
svd18 <- svd(scale(im18))
svd18$d^2/sum(svd18$d^2)
svd8 <- svd(im8)
svd18 <- svd(im18)
svd8$d^2/sum(svd8$d^2)
svd18$d^2/sum(svd18$d^2)
plot(svd18$d^2/sum(svd18$d^2),xlab="Column",ylab="Percent of variance explained",pch=19)
vars <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/quiz3question4.csv")
plot(vars$x,vars$y)
kmeansObj <- kmeans(vars,centers=2)
plot(vars$x,vars$y,col=kmeansObj$cluster,pch=19,cex=2)
kmeansObj <- kmeans(vars)
kmeansObj <- kmeans(vars,centers=1)
plot(vars$x,vars$y,col=kmeansObj$cluster,pch=19,cex=2)
kmeansObj <- kmeans(vars,centers=3)
plot(vars$x,vars$y,col=kmeansObj$cluster,pch=19,cex=2)
for (i in 1:10) plot(runif(10), ylim = 0:1)
rm(list=ls())
load.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt")
read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt")
?read.csv
read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\")
)
xx
x
x
rfvw
23e
\
?read.csv
?read.csv
read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\\")
View(dfMovies)
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\\\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\\\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\",allowEscapes=FALSE)
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\",allowEscapes=FALSE)
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\\")
dfMovies <- read.csv("https://spark-public.s3.amazonaws.com/dataanalysis/movies.txt",sep="\t")
View(dfMovies)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$box.office))
summary(lm1)
?confint
confint(lm1,level=.90)
confint(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$box.office) + as.numeric(dfMovies$running.time))
summary(lm1)
plot(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$running.time))
lm1 <- lm(as.numeric(dfMovies$score[dfMovies$running.time<180]) ~ as.numeric(dfMovies$box.office[dfMovies$running.time<180]) + as.numeric(dfMovies$running.time[dfMovies$running.time<180]))
plot(as.numeric(dfMovies$score[dfMovies$running.time<180]) ~ as.numeric(dfMovies$running.time[dfMovies$running.time<180]))
summary(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$running.time) + as.numeric(dfMovies$box.office))
summary(lm1)
anova(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$rating) + as.numeric(dfMovies$running.time) + as.numeric(dfMovies$rating) * as.numeric(dfMovies$running.time))
summary(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.factor(dfMovies$rating) + as.numeric(dfMovies$running.time) + as.factor(dfMovies$rating) * as.numeric(dfMovies$running.time))
summary(lm1)
data(warpbreaks)
view(warpbreaks)
View(warpbreaks)
View(warpbreaks)
lm1 <- lm(warpbreaks$breaks ~ as.factor(warpbreaks$tension))
lm1 <- lm(warpbreaks$breaks ~ relevel(warpbreaks$tension,ref="M"))
summary(lm1)
confint(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$box.office))
confint(lm1,level=.90)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$running.time) + as.numeric(dfMovies$box.office)) summary(lm1)
lm1 <- lm(as.numeric(dfMovies$score) ~ as.numeric(dfMovies$running.time) + as.numeric(dfMovies$box.office))
summary(lm1)
